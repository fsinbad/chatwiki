import{_ as G,b as J,B as se,e as ee,M as oe,E as ce}from"../../index-P5YTNo6V.js";import{a as _e,e as ue,g as pe,d as fe}from"./index-BsPTYS4_.js";import{r as S,L as e,M as m,F as K,a1 as V,a2 as de,Y as g,u as M,V as s,j as x,ab as ye,Q as c,X as D,a8 as T,E as ve,G as ge,P as $,a9 as R,a3 as ie,a4 as re,A as me,ac as he,U as ke,ad as we,b as te}from"./vue-chunks-DrvJJrR0.js";import{_ as be}from"./index-GBuEB8v_.js";import{F as le,_ as xe}from"./index-BUTxM_ZP.js";import"./index-BHxFUlgm.js";import{R as Ie,_ as Ce}from"./RadioButton-aF3UutsZ.js";import{S as Ae,_ as Me}from"./index-cbzy6J7k.js";import"./index-DbkTLXZJ.js";import{I as Te}from"./Input-Dgd5v23J.js";import{_ as $e}from"./index-BuUtNX0x.js";import{_ as Ke,a as Ee}from"./index-BdZgce9p.js";import{_ as Se}from"./index-Dh-ZljIv.js";import"./dayjs-Bv4VEw_C.js";import"./axios-Cm0UX6qg.js";import"./qs-QntUJHOZ.js";import"./crypto-js-BpV8n4kc.js";import"./colors-CF1NjnDv.js";import"./ResizeObserver.es-B1PUzC5B.js";import"./responsiveObserve-BH6_flfv.js";import"./collapseMotion-DfZt1qrJ.js";import"./QuestionCircleOutlined-Dtch7f6L.js";import"./FormItemContext-C-6BWMej.js";import"./index-DuYANmfA.js";import"./slide-BQHNwZxO.js";import"./index-CCuYH0LT.js";import"./CheckOutlined-C_vTn6Wi.js";import"./DownOutlined-BHsv0Dlx.js";import"./SearchOutlined-BsZdEpth.js";import"./move-DKHu4ARt.js";import"./Search-DbjjEMkL.js";import"./inputProps-CVwJ66mj.js";import"./TextArea-2ujELiW_.js";import"./Password-DoqQ5Cp-.js";import"./index-CDg2rIxr.js";import"./LeftOutlined-BqmAHDBI.js";import"./RightOutlined-DIZF9Vab.js";import"./index-DYXArsZx.js";import"./index-DpfcpfQ0.js";import"./dropdown-7DbQfkaS.js";import"./Dropdown-ZPlzQgPg.js";import"./index-CH9v5L6a.js";import"./shallowequal-CfnxU2uU.js";const Be={class:"page-tabs"},De=["onClick"],Le={__name:"page-tabs",props:{value:{type:[Number,String]}},emits:["update:value","change"],setup(n,{emit:_}){const{t:d}=J(),i=_,I=n,u=S([{value:1,title:d("views.user.model.modelsHaveBeenAdded"),langKey:"views.user.model.modelsHaveBeenAdded"},{value:0,title:d("views.user.model.canAddAModel"),langKey:"views.user.model.canAddAModel"}]),E=r=>{i("update:value",r),i("change",r)};return(r,k)=>(e(),m("div",Be,[(e(!0),m(K,null,V(u.value,w=>(e(),m("div",{class:de(["tab-item",{active:I.value==w.value}]),onClick:p=>E(w.value),key:w.value},g(M(d)(w.langKey)),11,De))),128))]))}},Ne=G(Le,[["__scopeId","data-v-5999ba44"]]),Oe=n=>(ie("data-v-72110a96"),n=n(),re(),n),Pe={class:"model-list"},Re={class:"model-item-left"},Ue={class:"model-item-left-top"},qe=["src"],Ve={class:"model-name"},ze=Oe(()=>s("div",{class:"line"},null,-1)),Fe={class:"model-tags"},Xe={key:0,class:"tag"},Ge={class:"model-item-left-bottom"},Je={class:"model-desc"},He={class:"model-item-right"},je={__name:"model-list",props:{type:{type:Number,default:()=>1},list:{type:Array,default:()=>[]}},emits:["edit","new","see","remove","add"],setup(n,{emit:_}){const{t:d}=J(),i=_,I=["azure","ollama","xinference","openaiAgent"],u=n,E=y=>{i("see",R(y))},r=y=>{let v=R(y);i("edit",v,v.config_list[0])},k=y=>{i("new",R(y))},w=y=>{i("add",R(y))},p=y=>{let v=R(y);i("remove",v.config_list[0])};return(y,v)=>{const U=be,f=se;return e(),m("div",Pe,[(e(!0),m(K,null,V(u.list,a=>(e(),m("div",{class:"model-item",key:a.model_define},[s("div",Re,[s("div",Ue,[s("img",{class:"model-logo",src:a.model_icon_url,alt:""},null,8,qe),s("div",Ve,g(a.model_name),1),ze,s("div",Fe,[(e(!0),m(K,null,V(a.support_list,(t,C)=>(e(),m("div",{key:C},[x(U,null,ye({default:c(()=>[t!="SPEECH2TEXT"&&t!="TTS"?(e(),m("span",Xe,g(t),1)):T("",!0)]),_:2},[t=="LLM"?{name:"title",fn:c(()=>[D("大语言模型，添加机器人时需要选择一个大语言模型。用户的提问将交由大语言模型，结合知识库给出答案。")]),key:"0"}:t=="TEXT EMBEDDING"?{name:"title",fn:c(()=>[D("嵌入模型，添加知识库时需要选择嵌入模型，用于将知识库分段向量化。用户提问时也会将问题生成向量，通过比对向量相似度的方式四配跟提问语义相近的知识库分段。向量检索具备很好的语义分析能力。")]),key:"1"}:t=="RERANK"?{name:"title",fn:c(()=>[D("重排序模型,通过重排序模型,将从知识库中检索出来的分段进行重新排序。再将重排序的结果前top-K传递个大语言模型生成答案。重排序有助于优化检索结果，提高大语言模型回答的准确性。")]),key:"2"}:void 0]),1024)]))),128))])]),s("div",Ge,[s("div",Je,g(a.introduce),1)])]),s("div",He,[ve(x(f,{class:de({"btn-red":a.listType==1&&u.type==1}),onClick:t=>p(a)},{default:c(()=>[D(g(a.listType==1&&u.type==1?"移除配置":"删除"),1)]),_:2},1032,["class","onClick"]),[[ge,u.type==1]]),u.type==2&&a.model_define!="azure"?(e(),$(f,{key:0,class:"add-btn",onClick:t=>E(a)},{default:c(()=>[D("查看模型")]),_:2},1032,["onClick"])):T("",!0),u.type==2?(e(),$(f,{key:1,disabled:a.listType==1,class:"add-btn",onClick:t=>w(a)},{default:c(()=>[D("添加配置")]),_:2},1032,["disabled","onClick"])):T("",!0),a.listType==1&&u.type==1?(e(),m(K,{key:2},[I.indexOf(a.model_define)>-1?(e(),m(K,{key:0},[x(f,{class:"add-btn",onClick:t=>E(a)},{default:c(()=>[D(g(M(d)("views.user.model.modelConfigButton"))+"（"+g(a.config_list.length)+"）",1)]),_:2},1032,["onClick"]),x(f,{class:"add-btn",onClick:t=>k(a)},{default:c(()=>[D(g(M(d)("views.user.model.addModelButton")),1)]),_:2},1032,["onClick"])],64)):(e(),m(K,{key:1},[x(f,{class:"add-btn",onClick:t=>r(a)},{default:c(()=>[D(g(M(d)("views.user.model.editModelButton")),1)]),_:2},1032,["onClick"]),x(f,{class:"add-btn",onClick:t=>E(a)},{default:c(()=>[D(g(M(d)("views.user.model.viewModelButton")),1)]),_:2},1032,["onClick"])],64))],64)):T("",!0)])]))),128))])}}},ne=G(je,[["__scopeId","data-v-72110a96"]]),O={componentType:"input",placeholder:"",defaultValue:""},Qe={componentType:"radio",defaultValue:void 0},Ye={componentType:"select",defaultValue:void 0},ae={id:{hidden:!0},model_types:{...Qe,key:"model_types",label:"模型类型",optionsKey:"supported_type",options:[],disabled:!1,rules:[{required:!0,message:"请选择模型类型",trigger:"change"}]},deployment_name:{...O,label:"部署名称",placeholder:"请与Azure 部署名称保持一致",rules:[{required:!0,message:"请输入部署名称",trigger:"change"}]},model_name:{...O,label:"模型名称",placeholder:"模型名称请保持一致",rules:[{required:!0,message:"请输入模型名称",trigger:"change"}]},api_endpoint:{...O,label:"API 域名",placeholder:"请输入您的API 域名",rules:[{required:!0,message:"请输入API 域名",trigger:"change"}]},model_context_length:{...O,label:"模型上下文长度",placeholder:"请输入您的模型上下文长度",rules:[{required:!0,message:"请输入模型上下文长度",trigger:"change"}]},model_uid:{...O,label:"模型UID",placeholder:"请输入您的模型UID",rules:[{required:!0,message:"请输入模型UID",trigger:"change"}]},api_key:{...O,label:"API Key",placeholder:"请输入您的API Key",rules:[{required:!0,message:"请输入API Key",trigger:"change"}]},secret_key:{...O,label:"Secret Key",placeholder:"请输入您的Secret Key",rules:[{required:!0,message:"请输入Secret Key",trigger:"change"}]},api_version:{...Ye,label:"API 版本",placeholder:"请输入您的API 版本",optionsKey:"api_versions",options:[],rules:[{required:!0,message:"请选择API 版本",trigger:"change"}]},app_id:{...O,label:"appid",placeholder:"请输入appid",rules:[{required:!0,message:"请输入appid",trigger:"change"}]},region:{...O,label:"region",placeholder:"请输入地区",rules:[{required:!0,message:"请输入地区",trigger:"change"}]}};function We(n){if(ae[n])return ae[n];let _={...O};return _.placeholder="请输入您的"+n,_}const Ze={columns:[{title:"模型名称",dataIndex:"model_name",key:"model_name",langKey:"views.user.model.model_name"},{title:"模型类型",dataIndex:"model_type",key:"model_type",langKey:"views.user.model.model_type"}],rows:[],showAddBtn:!1},eo={azure:{columns:[{title:"部署名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"API版本",dataIndex:"api_version",key:"api_version",langKey:"views.user.model.api_version"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},ollama:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"BaseURL",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},openaiAgent:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"BaseURL",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"API Key",dataIndex:"api_key",key:"api_key",langKey:"views.user.model.api_key"},{title:"API版本",dataIndex:"api_version",key:"api_version",langKey:"views.user.model.api_version"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0},xinference:{columns:[{title:"模型名称",dataIndex:"deployment_name",key:"deployment_name",langKey:"views.user.model.deployment_name"},{title:"模型类型",dataIndex:"model_types",key:"model_types",langKey:"views.user.model.model_types"},{title:"服务器地址",dataIndex:"api_endpoint",key:"api_endpoint",langKey:"views.user.model.api_endpoint"},{title:"操作",dataIndex:"action",key:"action",width:150,langKey:"common.action"}],rows:[],showAddBtn:!0}},oo=["azure","ollama","xinference","openaiAgent"];function to(n){if(oo.indexOf(n.model_define)>-1)return n.config_list;{let _=[];return n.llm_model_list||(n.llm_model_list=[]),n.llm_model_list.forEach(d=>{_.push({model_name:d,model_type:"LLM"})}),n.vector_model_list||(n.vector_model_list=[]),n.vector_model_list.forEach(d=>{_.push({model_name:d,model_type:"TEXT EMBEDDING"})}),_}}function lo(n){let _=["model_define","model_icon_url"],d=eo[n.model_define];return d||(d=Ze),_.forEach(i=>{d[i]=n[i]}),d.rows=to(n),d}const no={class:"form-wrapper"},ao={class:"model-logo-box"},so=["src"],io={key:0,href:"https://www.yuque.com/zhimaxiaoshiwangluo/pggco1/hmwl4gveq4xwa4uw?singleDoc# ",target:"_blank"},ro={class:"form-box"},mo={class:"form-item-label"},co={key:0},_o={key:1},uo=["href"],po={__name:"set-model-alert",emits:["ok"],setup(n,{expose:_,emit:d}){const{t:i}=J(),I=d,u=le.useForm,E=S(""),r=me({model_icon_url:"",model_define:"",model_name:""}),k=S(!1),w=S({}),p=S({}),y=S([]),v=["ollama","xinference","openaiAgent"],U=(b,l)=>{w.value={},p.value={},y.value=[];const{model_icon_url:Y,model_define:W,config_params:j,model_name:F}=b;E.value=l?i("common.edit")+" "+F:i("common.add")+" "+F,r.model_icon_url=Y,r.model_define=W,r.model_name=F;let N={},z={},X=[];j.unshift("id"),j.forEach(h=>{h=="model_type"&&(h="model_types"),v.indexOf(b.model_define)>-1&&h=="deployment_name"&&(h="model_name");let o=We(h);o.key=h,o.help_links=b.help_links,o.disabled=!1,o.key=="model_types"&&l&&(o.disabled=!0);let A=o.options;l?(v.indexOf(l.model_define)>-1&&l.deployment_name&&(l.model_name=l.deployment_name),z[h]=l[h]||void 0):z[h]=o.defaultValue,o.optionsKey&&b[o.optionsKey]&&(A=b[o.optionsKey]),o.hidden||X.push({...o,options:A,key:h}),o.rules&&(N[h]=o.rules)}),b.model_define=="doubao"?(l||(z.region="cn-beijing"),X.forEach(h=>{h.key=="deployment_name"&&(h.placeholder="请输入接入点ID")}),N.deployment_name&&N.deployment_name.length&&(N.deployment_name[0].message="请输入接入点ID")):N.deployment_name&&N.deployment_name.length&&(N.deployment_name[0].message="请输入部署名称"),w.value=N,p.value=z,y.value=X,k.value=!0,setTimeout(()=>{a()},100)},{resetFields:f,clearValidate:a,validate:t,validateInfos:C}=u(p,w),B=()=>{t().then(()=>{p.value.id?H():L()}).catch(b=>{})},q=()=>{f(),a()},P=S(!1),L=()=>{let b=R(p.value),l=JSON.parse(JSON.stringify(b));l.model_type=l.model_types,l.model_define=r.model_define,v.indexOf(l.model_define)>-1&&l.model_name&&(l.deployment_name=l.model_name,delete l.model_name),P.value=!0,_e(l).then(()=>{P.value=!1,k.value=!1,ee.success(i("common.saveSuccess")),I("ok")}).catch(()=>{P.value=!1})},H=()=>{let b=R(p.value),l=JSON.parse(JSON.stringify(b));l.model_type=l.model_types,l.model_define=r.model_define,v.indexOf(l.model_define)>-1&&l.model_name&&(l.deployment_name=l.model_name,delete l.model_name),P.value=!0,ue(l).then(()=>{P.value=!1,k.value=!1,ee.success(i("common.saveSuccess")),I("ok")}).catch(()=>{P.value=!1})};return _({open:U}),(b,l)=>{const Y=Ie,W=Ce,j=Ae,F=Me,N=Te,z=xe,X=le,h=oe;return e(),$(h,{class:"add-model-alert",width:"650px",open:k.value,"onUpdate:open":l[0]||(l[0]=o=>k.value=o),title:E.value,confirmLoading:P.value,onOk:B,onCancel:q,maskClosable:!1},{default:c(()=>[s("div",no,[s("div",ao,[s("img",{class:"model-logo",src:r.model_icon_url,alt:""},null,8,so),r.model_define=="doubao"?(e(),m("a",io,"查看使用说明>")):T("",!0)]),s("div",ro,[x(X,{layout:"horizontal","label-col":{span:6},"wrapper-col":{span:18}},{default:c(()=>[(e(!0),m(K,null,V(y.value,o=>(e(),m(K,{key:o.key},[o.hidden?T("",!0):(e(),$(z,he(ke({key:0},M(C)[o.key])),{label:c(()=>[s("div",mo,[r.model_define=="doubao"&&o.key=="deployment_name"?(e(),m("span",co,"接入点ID")):(e(),m("span",_o,g(M(i)("views.user.model."+o.key)),1))])]),default:c(()=>[o.componentType=="radio"?(e(),$(W,{key:0,value:p.value[o.key],"onUpdate:value":A=>p.value[o.key]=A,disabled:o.disabled},{default:c(()=>[(e(!0),m(K,null,V(o.options,(A,Z)=>(e(),$(Y,{value:A,key:Z},{default:c(()=>[s("span",null,g(A),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","disabled"])):T("",!0),o.componentType=="select"?(e(),$(F,{key:1,value:p.value[o.key],"onUpdate:value":A=>p.value[o.key]=A,placeholder:o.placeholder},{default:c(()=>[(e(!0),m(K,null,V(o.options,(A,Z)=>(e(),$(j,{value:A,key:Z},{default:c(()=>[s("span",null,g(A),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","placeholder"])):T("",!0),o.componentType=="input"?(e(),m(K,{key:2},[x(N,{value:p.value[o.key],"onUpdate:value":A=>p.value[o.key]=A,placeholder:o.placeholder},null,8,["value","onUpdate:value","placeholder"]),o.key=="api_key"?(e(),m("a",{key:0,href:o.help_links,target:"_blank"},g(M(i)("views.user.model.getApikeyText")),9,uo)):T("",!0)],64)):T("",!0)]),_:2},1040))],64))),128))]),_:1})])])]),_:1},8,["open","title","confirmLoading"])}}},fo=G(po,[["__scopeId","data-v-2243b038"]]),yo={class:"form-wrapper"},vo={class:"tools-wrapper"},go=["src"],ho={class:"tools-box"},ko={class:"list-box"},wo=["onClick"],bo=["onClick"],xo={__name:"see-model-alert",emits:["new","edit","remove"],setup(n,{expose:_,emit:d}){const{t:i}=J(),I=d,u=S(!1),E=["ollama","xinference","openaiAgent"],r=me({model_icon_url:"",model_define:"",columns:[],rows:[],showAddBtn:!1});let k=we({});const w=f=>{k=f;let a=lo(f);for(let t in a)r[t]=a[t];u.value=!0},p=()=>{u.value=!1,I("new",{...k})},y=f=>{u.value=!1,I("edit",{...k},R(f))},v=f=>{u.value=!1,I("remove",R(f))},U=()=>{};return _({open:w}),(f,a)=>{const t=se,C=$e,B=Ke,q=Ee,P=oe;return e(),$(P,{class:"add-model-alert",width:"800px",open:u.value,"onUpdate:open":a[0]||(a[0]=L=>u.value=L),title:M(i)("views.user.model.modelConfigButton"),footer:null,onOk:U},{default:c(()=>[s("div",yo,[s("div",vo,[s("img",{class:"model-logo",src:r.model_icon_url,alt:""},null,8,go),s("div",ho,[r.showAddBtn?(e(),$(t,{key:0,type:"primary",onClick:p},{default:c(()=>[D(g(M(i)("views.user.model.addModel")),1)]),_:1})):T("",!0)])]),s("div",ko,[x(q,{"data-source":r.rows,scroll:{y:400},pagination:!1},{default:c(()=>[(e(!0),m(K,null,V(r.columns,L=>(e(),m(K,{key:L.key},[L.key=="action"?(e(),$(B,{key:0,title:M(i)("common.action"),"data-index":L.key,width:"140px"},{default:c(({record:H})=>[s("span",null,[s("a",{onClick:b=>y(H)},g(M(i)("common.edit")),9,wo),x(C,{type:"vertical"}),s("a",{onClick:b=>v(H)},g(M(i)("common.remove")),9,bo)])]),_:2},1032,["title","data-index"])):(e(),$(B,{key:1,title:M(i)("views.user.model."+(E.indexOf(r.model_define)>-1&&L.key=="deployment_name"?"model_name":L.key)),"data-index":L.key},null,8,["title","data-index"]))],64))),128))]),_:1},8,["data-source"])])])]),_:1},8,["open","title"])}}},Io=G(xo,[["__scopeId","data-v-905dacec"]]),Q=n=>(ie("data-v-1f3aa710"),n=n(),re(),n),Co={class:"user-model-page"},Ao={class:"list-wrapper"},Mo={key:0,class:"alert-content-box"},To=Q(()=>s("div",{class:"title"},"使用说明",-1)),$o=Q(()=>s("div",null,"1、模型主要分为嵌入模型（TEXT EMBEDDING）和大模型（LLM），嵌入模型用于将上传知识库的文本内容进行向量化便于后续检索，大模型用于将检索到的相关知识进行理解后返回答案。",-1)),Ko=Q(()=>s("div",null,"2、配置模型时尽量选择同时支持LLM和TEXT EMBEDDING的模型，否则要配置多个模型。",-1)),Eo=Q(()=>s("div",null,"3、国内模型厂商一般都需要认证后才可使用，所以在配置模型前，确保在模型服务厂商那里已认证，否则配置模型时会提示配置参数错误。",-1)),So={__name:"index",setup(n){const{t:_}=J(),d=S(1),i=()=>{},I=S([]),u=te(()=>I.value.filter(t=>t.listType==1)),E=te(()=>I.value),r=()=>{pe().then(t=>{let C=t.data||[];C.forEach(B=>{B.listType=B.config_list.length>0?1:0}),C.sort((B,q)=>B.listType-q.listType),I.value=C})};r();const k=S(null),w=t=>{k.value.open(t)},p=t=>{v.value.open(t)},y=t=>{v.value.open(t)},v=S(null),U=(t,C)=>{v.value.open(t,C)},f=()=>{r()},a=t=>{oe.confirm({title:_("views.user.model.deleteModel"),icon:x(ce),content:_("views.user.model.deleteModelContent"),onOk(){fe({id:t.id}).then(()=>{ee.success(_("common.deleteSuccessful")),r()})}})};return(t,C)=>{const B=Se;return e(),m(K,null,[s("div",Co,[x(Ne,{value:d.value,"onUpdate:value":C[0]||(C[0]=q=>d.value=q),onChange:i},null,8,["value"]),s("div",Ao,[d.value==0?(e(),m("div",Mo,[x(B,{"show-icon":""},{message:c(()=>[To,$o,Ko,Eo]),_:1})])):T("",!0),d.value==1?(e(),$(ne,{list:u.value,type:1,key:"addedModelList",onEdit:U,onNew:p,onSee:w,onRemove:a},null,8,["list"])):T("",!0),d.value==0?(e(),$(ne,{list:E.value,type:2,key:"canAddModelList",onAdd:y,onSee:w},null,8,["list"])):T("",!0)])]),x(Io,{ref_key:"seeModelAlertRef",ref:k,onNew:p,onEdit:U,onRemove:a},null,512),x(fo,{ref_key:"setModelAlertRef",ref:v,onOk:f},null,512)],64)}}},bt=G(So,[["__scopeId","data-v-1f3aa710"]]);export{bt as default};
